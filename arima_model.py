import pandas as pd
from statsmodels.tsa.arima.model import ARIMA

# Provided data (96 dates)
dates = [
    '2013-01-31', '2013-02-28', '2013-03-31', '2013-04-30', '2013-05-31',
    '2013-06-30', '2013-07-31', '2013-08-31', '2013-09-30', '2013-10-31',
    '2013-11-30', '2013-12-31', '2014-01-31', '2014-02-28', '2014-03-31',
    '2014-04-30', '2014-05-31', '2014-06-30', '2014-07-31', '2014-08-31',
    '2014-09-30', '2014-10-31', '2014-11-30', '2014-12-31', '2015-01-31',
    '2015-02-28', '2015-03-31', '2015-04-30', '2015-05-31', '2015-06-30',
    '2015-07-31', '2015-08-31', '2015-09-30', '2015-10-31', '2015-11-30',
    '2015-12-31', '2016-01-31', '2016-02-29', '2016-03-31', '2016-04-30',
    '2016-05-31', '2016-06-30', '2016-07-31', '2016-08-31', '2016-09-30',
    '2016-10-31', '2016-11-30', '2016-12-31', '2017-01-31', '2017-02-28',
    '2017-03-31', '2017-04-30', '2017-05-31', '2017-06-30', '2017-07-31',
    '2017-08-31', '2017-09-30', '2017-10-31', '2017-11-30', '2017-12-31',
    '2018-01-31', '2018-02-28', '2018-03-31', '2018-04-30', '2018-05-31',
    '2018-06-30', '2018-07-31', '2018-08-31', '2018-09-30', '2018-10-31',
    '2018-11-30', '2018-12-31', '2019-01-31', '2019-02-28', '2019-03-31',
    '2019-04-30', '2019-05-31', '2019-06-30', '2019-07-31', '2019-08-31',
    '2019-09-30', '2019-10-31', '2019-11-30', '2019-12-31', '2020-01-31',
    '2020-02-29', '2020-03-31', '2020-04-30', '2020-05-31', '2020-06-30',
    '2020-07-31', '2020-08-31', '2020-09-30', '2020-10-31', '2020-11-30',
    '2020-12-31'
]

# Provided rice prices (first 96 prices only, last four removed)
rice_prices = [
    15.30, 15.00, 15.20, 15.40, 15.50, 15.60, 15.80, 15.60, 15.60, 15.40,
    15.50, 15.50, 15.40, 15.40, 15.60, 15.60, 15.40, 15.40, 15.10, 12.80,
    12.60, 12.60, 12.60, 12.50, 12.00, 11.90, 12.30, 12.30, 12.30, 12.80,
    13.30, 13.10, 11.80, 11.50, 11.70, 11.70, 12.10, 11.80, 11.50, 10.80,
    11.30, 11.60, 12.00, 12.20, 10.30, 10.30, 10.30, 10.30, 10.60, 10.10,
    10.10, 10.10, 10.20, 10.20, 10.80, 11.30, 11.60, 11.90, 12.00, 11.90,
    11.90, 12.40, 11.80, 13.10, 12.80, 13.10, 13.70, 14.30, 12.50, 11.90,
    12.20, 12.90, 13.50, 12.40, 11.90, 12.00, 11.90, 12.20, 12.90, 12.70,
    12.50, 12.40, 12.00, 13.90, 14.10, 13.80, 14.10, 14.50, 14.90, 14.70,
    15.80, 13.70, 13.70, 14.10, 13.80, 14.10
]

# Check and confirm the lengths
print("Length of 'Date' list:", len(dates))
print("Length of 'Rice_Price' list:", len(rice_prices))

# Convert dates to datetime and create DataFrame
df = pd.DataFrame({
    'Date': pd.to_datetime(dates),
    'Rice_Price': rice_prices
})
df.set_index('Date', inplace=True)

# Function to predict rice price
def predict_rice_price(input_date):
    # Fit ARIMA model
    model = ARIMA(df['Rice_Price'], order=(1, 1, 1))
    model_fit = model.fit()

    # Predict
    input_date = pd.to_datetime(input_date)
    prediction = model_fit.predict(start=input_date, end=input_date)
    
    return prediction.iloc[0] if not prediction.empty else None

# Example usage
if __name__ == "__main__":
    input_date = '2021-01-31'  # Example date
    predicted_price = predict_rice_price(input_date)
    print(f"Predicted Price on {input_date}: {predicted_price}")
